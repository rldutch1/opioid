<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
// ----------------------------------------------------------------------------
// Author: Robert Holland
// Script Name: index.html
// Creation Date: Mon Jun 13 2011 15:45:24 GMT-0700 (US Mountain Standard Time)
// Last Modified: 9/3/2019 16:55:08
// Copyright 2011
// Purpose:  Approximate Opioid Conversion Calculator.
// ----------------------------------------------------------------------------
-->
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">

function formReset()
 {
// document.getElementById("form1").reset(MorphEquiv());
// document.getElementById("form1").reset();
 document.getElementById("form1").reset();
 }

function setTabIndex()
{
		document.getElementById('1').tabIndex="1";
		document.getElementById('2').tabIndex="2";
		document.getElementById('3').tabIndex="3";
		document.getElementById('4').tabIndex="4";
		document.getElementById('5').tabIndex="5";
		document.getElementById('6').tabIndex="6";
		document.getElementById('7').tabIndex="7";
		document.getElementById('8').tabIndex="8";
		document.getElementById('9').tabIndex="9";
		document.getElementById('10').tabIndex="10";
		document.getElementById('11').tabIndex="11";
		document.getElementById('12').tabIndex="12";
		document.getElementById('13').tabIndex="13";
		document.getElementById('14').tabIndex="14";
		document.getElementById('15').tabIndex="15";
}

var b3, b4, b5, b6, b7, b8, b9, b10, b11, b12, b13, b14, b15, b16, b17, b18, b19, e3, e5, e7, e9, e11;

function MorphEquiv()
{
		b3 = parseFloat(document.form1.morphivim.value);
		b4 = parseFloat(document.form1.morphirpo.value);
		b5 = parseFloat(document.form1.morphsrpo.value);
		b6 = parseFloat(document.form1.oxycopo.value);
		b7 = parseFloat(document.form1.oxycosrpo.value);
		b8 = parseFloat(document.form1.meperivim.value);
		b9 = parseFloat(document.form1.hydrocopo.value);
		b10 = parseFloat(document.form1.fentaniv.value);
		b11 = parseFloat(document.form1.percocet.value);
		b12 = parseFloat(document.form1.fentantran.value);
		b13 = parseFloat(document.form1.hytromorphiv.value);
		b14 = parseFloat(document.form1.hydromorphopo.value);
		b15 = parseFloat(document.form1.methadoniv.value);
		b16 = parseFloat(document.form1.methadonpo.value);
		b17 = parseFloat((0));
		b18 = parseFloat((0));
		b19 = parseFloat((0));

		e9 = b3 +(b4/3)+(b5/3)+(b8/7.5)+(b9/30)+(b15*9)+(b16*9/2)+(b13/0.15)+(b14/0.45)+(b17/0.2)+(b6*2/3)+(b7*2/3)+(b10*0.1)+(b18/20)+(b12*0.48)+(b19/30)+(b11*0.66*5);
		e3 = (e9 * 3);
		e5 = Math.round(e9 * 3 * 0.5);
		e7 = Math.round(e9 * 3 * 0.5);
		e11 = (e9 / 8);

		document.form1.mscequiv.value = e3.toFixed(1)
		document.form1.oxyconequiv.value = e5.toFixed(1)
		document.form1.oxycodequiv.value = e7.toFixed(1)
		document.form1.ivmorpho.value = e9.toFixed(1)
		document.form1.ivhydrmorpho.value = e11.toFixed(1)

var alertmsg ='';
if (isNaN(b3) == true|| b3 < 0)
     {
     alertmsg = alertmsg + "Morphine IV/IM (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b4) == true|| b4 < 0)
     {
     alertmsg = alertmsg + "Morphine IR-PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b5) == true|| b5 < 0)
     {
     alertmsg = alertmsg + "Morphine SR-PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b6) == true|| b6 < 0)
     {
     alertmsg = alertmsg + "Oxycodone PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b7) == true|| b7 < 0)
     {
     alertmsg = alertmsg + "Oxycodone SR-PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b8) == true|| b8 < 0)
     {
     alertmsg = alertmsg + "Meperidine IV/IM (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b9) == true|| b9 < 0)
     {
     alertmsg = alertmsg + "Hydrocodone PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b10) == true|| b10 < 0)
     {
     alertmsg = alertmsg + "Fentanyl IV (mcg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b11) == true|| b11 < 0)
     {
     alertmsg = alertmsg + "Perco-cet/dan 5mg (#) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b12) == true|| b12 < 0)
     {
     alertmsg = alertmsg + "Fentanyl TransD (mcg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b13) == true|| b13 < 0)
     {
     alertmsg = alertmsg + "Hytromorphone IV (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b14) == true|| b14 < 0)
     {
     alertmsg = alertmsg + "Hydromorphone PO (mg) has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b15) == true|| b15 < 0)
     {
     alertmsg = alertmsg + "Methadone IV (mg)* has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
if (isNaN(b16) == true|| b16 < 0)
     {
     alertmsg = alertmsg + "Methadone PO (mg)* has an invalid entry!" +"\n";
     alert(alertmsg);
     formReset();
     }
}

function MorphTab()
{
	MorphEquiv();
	setTabIndex();
}

$(document).ready(function(){
  $("#15").click(function(){
			$(document.getElementById("form1").reset());
  });
});

</script>

</head>
<body onload="MorphTab()">
<style type="text/css">
body {
	background-color: #000000;
	background-repeat: repeat-x;
}

div {
  border-radius: 5px;
  background-color: #000000;
  padding: 2px;
}

table,td,th
{
border:1px solid black;
}
table
{
width:50%;
border-collapse:collapse;
}
th
{
height:10px;
}
td {
	style="white-space:nowrap"
}
.tHeadW {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 14px;
	font-weight: bold;
	color: #FF0000;
	line-height: 30px;
	text-indent: 10px;
}
.tHeadA {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 14px;
	font-weight: bold;
	color: #7030A0;
	line-height: 30px;
	text-indent: 10px;
}
.tBodyW {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 13px;
	font-weight: normal;
	color: #000000;
	padding-left: 5px;
	padding-right: 5px;
	line-height: normal;
	padding-bottom: 5px;
	padding-top: 5px;
	background-color: #55B23C;
}
.tBodyA {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 13px;
	font-weight: normal;
	color: #ffffff;
	padding-left: 5px;
	line-height: normal;
	padding-bottom: 5px;
	padding-top: 5px;
	background-color: #7030A0;
}
.tBodyI {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 13px;
	font-weight: normal;
	color: #000000;
	padding-left: 5px;
	padding-right: 5px;
	line-height: normal;
	padding-bottom: 5px;
	padding-top: 5px;
	background-color: #7030A0;
}
.tmessage {
	color="FF0000";
}
</style>
<br /><br />
<center>
<div id="opiCalcForm"><!-- Add usage directions to table -->
<form id="form1" action="opioids.fresh.html" name="form1" onclick="setTabIndex()">
  <table width="70%" border="1" cellpadding="1" cellspacing="1" id="OpiateTable">
  	<!-- <caption>
  		Approximate Opioid Conversion Calculator
  	</caption>
  	-->
    <tr>
      <th class="tHeadW" colspan="4" align="center"> Approximate Opioid Conversion Calculator </th>
    </tr>
    <tr>
    	<th nowrap="nowrap" colspan="4" align="left">Opioids (mg or mcg/day)</th>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Morphine IV/IM (mg)</th>
      <td class="tBodyW"><input id="1" type="text" name="morphivim" value="0" size="5" onblur="MorphEquiv();"/></td>
      <th nowrap="nowrap" class="tBodyA" >MSContin Equiv.(mg) =</th>
      <td class="tBodyI"><input type="text" name="mscequiv" value="0" size="5" readonly="true"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Morphine IR-PO (mg)</th>
      <td class="tBodyW"><input id="2" type="text" name="morphirpo" value="0" size="5" onblur="MorphEquiv();"/></td>
      <th nowrap="nowrap" class="tBodyA">Oxycontin Equiv.(mg) =</th>
      <td class="tBodyI"><input type="text" name="oxyconequiv" value="0" size="5" readonly="true"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Morphine SR-PO (mg)</th>
      <td class="tBodyW"><input id="3" type="text" name="morphsrpo" value="0" size="5" onblur="MorphEquiv();"/></td>
      <th nowrap="nowrap" class="tBodyA">Oxycodone IR Equiv.(mg) =</th>
      <td class="tBodyI"><input type="text" name="oxycodequiv" value="0" size="5" readonly="true" /></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Oxycodone PO (mg)</th>
      <td class="tBodyW"><input id="4" type="text" name="oxycopo" value="0" size="5" onblur="MorphEquiv();"/></td>
      <th nowrap="nowrap" class="tBodyA">IV Morphine Equiv.(mg) =</th>
      <td class="tBodyI"><input type="text" name="ivmorpho" value="0" size="5" readonly="true"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Oxycodone SR-PO (mg)</th>
      <td class="tBodyW"><input id="5" type="text" name="oxycosrpo" value="0" size="5" onblur="MorphEquiv();"/></td>
      <th nowrap="nowrap" class="tBodyA">IV HYDROmorphone Equiv.(mg) =</th>
      <td class="tBodyI"><input type="text" name="ivhydrmorpho" value="0" size="5" readonly="true"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Meperidine IV/IM (mg)</th>
      <td class="tBodyW"><input id="6" type="text" name="meperivim" value="0" size="5" onblur="MorphEquiv();"/></td>
      <td class="tBodyX" colspan="2" rowspan="4"><font color="FF0000">Enter the appropriate amounts of opioid in the <font color="55B23C">
  green</font> data cells.
Percocet presumes the 5mg oxycodone component, so <u><font color="7030A0">just enter the number of tablets</font></u>.
All other drugs enter mg or mcg amt.
Methadone conversions* can only be approximate.
Current conversion 9:1. Other opioids are fairly standard conversions.
Read out relative equivalents per day in the right cells</font>.
      </td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Hydrocodone PO (mg)</th>
      <td class="tBodyW"><input id="7" type="text" name="hydrocopo" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Fentanyl IV (mcg)</th>
      <td class="tBodyW"><input id="8" type="text" name="fentaniv" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Perco-cet/dan 5mg (#)</th>
      <td class="tBodyW"><input id="9" type="text" name="percocet" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Fentanyl TransD (mcg)</th>
      <td class="tBodyW"><input id="10" type="text" name="fentantran" value="0" size="5" onblur="MorphEquiv();"/></td>
      <td colspan="2" rowspan="4"><font color="FF0000">This tool should not be used to replace judgment from a licenced clinician.</font>
      </td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Hytromorphone IV (mg)</th>
      <td class="tBodyW"><input id="11" type="text" name="hytromorphiv" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadW">Hydromorphone PO (mg)</th>
      <td class="tBodyW"><input id="12" type="text" name="hydromorphopo" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadA">Methadone IV (mg)*</th>
      <td class="tBodyW"><input id="13" type="text" name="methadoniv" value="0" size="5" onblur="MorphEquiv();"/></td>
    </tr>
    <tr>
      <th nowrap="nowrap" class="tHeadA">Methadone PO (mg)*</th>
      <td class="tBodyW"><input id="14" type="text" name="methadonpo" value="0" size="5" onblur="MorphEquiv();"/></td>
			<th align="right" colspan="2"><center><i id="15" type="reset"><h3><b class="tmessage"><font color="FF0000">Reset</font></b></h3></i></center><!-- <input id="15" type="reset"/> --></th>
			<!-- <td align="right"><button id="15" type="button" onclick="MorphEquiv()">Display Total</button></td> -->
    </tr>
		<tr>
			<td colspan="4"><font color="FF0000">Click anywhere to update conversion.</font></td>
			<!-- <td align="center"><input type="reset"/></td>
			<td><button id="15" type="button" onclick="MorphEquiv()">Display Total</button></td> -->
		</tr>
  </table>
  </form>
</div>
</center>
</body>
</html>
